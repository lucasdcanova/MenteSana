import{c as h,d as x,r as d,j as e,C as j,f as y,k as g,aT as f,g as N,h as C,H as v,B as r,I as k}from"./index-DKFI7ZyH.js";import{C as w}from"./circle-check-C5HjS40s.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=h("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);function E(){const[,o]=x(),[s,c]=d.useState("loading"),[t,p]=d.useState({session:{id:null,date:"",therapist:""},amount:"",paymentId:""});return d.useEffect(()=>{const m=new URLSearchParams(window.location.search),i=m.get("payment_intent");m.get("redirect_status")==="succeeded"&&i?(async()=>{var l,u;try{const n=await k("GET",`/api/payments/details/${i}`);if(!n.ok)throw new Error("Falha ao obter detalhes do pagamento");const a=await n.json();p({session:{id:((l=a.session)==null?void 0:l.id)||null,date:a.session?new Date(a.session.date).toLocaleDateString("pt-BR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",therapist:((u=a.session)==null?void 0:u.therapist)||"Terapeuta"},amount:`R$ ${(a.payment.amount||0).toFixed(2)}`,paymentId:a.payment.paymentIntentId||i}),c("success")}catch(n){console.error("Erro ao buscar detalhes do pagamento:",n),c("error")}})():c("error")},[]),e.jsx("div",{className:"container max-w-md mx-auto py-12",children:e.jsxs(j,{className:"border-primary/20",children:[e.jsxs(y,{className:"text-center",children:[s==="loading"?e.jsx("div",{className:"flex justify-center",children:e.jsx(g,{className:"h-12 w-12 animate-spin text-primary"})}):s==="success"?e.jsx(w,{className:"h-12 w-12 text-green-500 mx-auto mb-2"}):e.jsx("div",{className:"text-destructive",children:"Não foi possível confirmar o pagamento"}),e.jsx(f,{className:"text-2xl mt-4",children:s==="loading"?"Verificando pagamento...":s==="success"?"Pagamento Concluído!":"Falha no Pagamento"}),e.jsx(N,{children:s==="success"?"Seu pagamento foi processado com sucesso":s==="loading"?"Estamos verificando o status do seu pagamento":"Não foi possível processar seu pagamento"})]}),e.jsxs(C,{children:[s==="success"&&e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[e.jsxs("h3",{className:"font-medium flex items-center mb-2",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Detalhes da Consulta"]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:["Terapeuta: ",e.jsx("span",{className:"font-medium",children:t.session.therapist})]}),e.jsxs("p",{children:["Data: ",e.jsx("span",{className:"font-medium",children:t.session.date})]}),e.jsxs("p",{children:["Valor: ",e.jsx("span",{className:"font-medium",children:t.amount})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["ID do Pagamento: ",t.paymentId]})]})]}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[e.jsx("p",{children:"Um recibo foi enviado para seu e-mail."}),e.jsx("p",{children:"A consulta já está confirmada em sua agenda."})]})]}),s==="error"&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"mb-4 text-sm",children:"Ocorreu um problema ao confirmar seu pagamento. Por favor, entre em contato com nosso suporte ou tente novamente."})})]}),e.jsx(v,{className:"flex justify-center gap-4",children:s==="success"?e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"outline",onClick:()=>o("/agenda"),children:"Ver Agenda"}),e.jsx(r,{onClick:()=>o("/"),children:"Voltar ao Início"})]}):s==="error"?e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"outline",onClick:()=>window.history.back(),children:"Voltar"}),e.jsx(r,{onClick:()=>o("/"),children:"Página Inicial"})]}):null})]})})}export{E as default};
