import{u as q,b as L,d as F,r as c,y as I,I as _,j as e,B as o,ba as z,C as h,f as y,aN as H,h as p,G as V,bf as G,E as b,b2 as Q,aT as U,bb as S,i as O,H as J}from"./index-DKFI7ZyH.js";import{T as K,a as W,b as m}from"./tabs-BarOwXjl.js";import{B as X}from"./badge-CsDoxorc.js";import{A as P,b as M,a as T}from"./avatar-Dqs0JyeB.js";import{S as u}from"./skeleton-CDe7BuYf.js";import{P as Y}from"./plus-BTDcvFex.js";import{S as Z}from"./search-D9RKuYgR.js";import{A as ee}from"./arrow-up-right-BHeB4xDn.js";import{T as se}from"./trending-up-CxFJ2zAi.js";import{M as C}from"./message-square-COtO5yp6.js";import{S as ae}from"./square-pen-C8JeLqTz.js";function pe(){const{user:l}=q(),{toast:N}=L(),[A,f]=F(),[d,D]=c.useState(""),[a,E]=c.useState(null),[j,R]=c.useState("all");console.log("[TherapistPatientsPage] Página carregada, usuário:",l,"location:",A),c.useEffect(()=>{l&&!l.isTherapist&&(N({title:"Acesso negado",description:"Você não tem permissão para acessar esta página",variant:"destructive"}),f("/"))},[l,N,f]);const{data:x,isLoading:B}=I({queryKey:["/api/patients"],queryFn:async()=>{const t=await(await _("GET","/api/patients")).json();return t&&t.length>0?t.map(r=>({...r,lastSession:g(60),nextSession:g(-30),sessionCount:Math.floor(Math.random()*20)+1,progress:Math.floor(Math.random()*100),recentMoods:$(),journalEntries:Math.floor(Math.random()*50)+1,medicalRecords:Math.floor(Math.random()*10)})):[{id:100,username:"maria_silva",firstName:"Maria",lastName:"Silva",email:"maria@example.com",isTherapist:!1,profilePicture:null,dateOfBirth:new Date("1995-05-15"),bio:"Paciente desde janeiro de 2025",lastSession:"02/04/2025",nextSession:"15/04/2025",sessionCount:12,progress:68,recentMoods:["Ansioso","Estressado","Esperançoso"],journalEntries:34,medicalRecords:3},{id:101,username:"joao_santos",firstName:"João",lastName:"Santos",email:"joao@example.com",isTherapist:!1,profilePicture:null,dateOfBirth:new Date("1988-10-23"),bio:"Paciente desde fevereiro de 2025",lastSession:"28/03/2025",nextSession:"11/04/2025",sessionCount:8,progress:45,recentMoods:["Deprimido","Cansado"],journalEntries:15,medicalRecords:2},{id:102,username:"ana_oliveira",firstName:"Ana",lastName:"Oliveira",email:"ana@example.com",isTherapist:!1,profilePicture:null,dateOfBirth:new Date("1992-03-07"),bio:"Paciente desde março de 2025",lastSession:"01/04/2025",nextSession:"08/04/2025",sessionCount:4,progress:22,recentMoods:["Motivado","Feliz"],journalEntries:7,medicalRecords:1}]},enabled:!!(l!=null&&l.isTherapist)});function g(s){const t=new Date;return t.setDate(t.getDate()-(s>0?Math.floor(Math.random()*s):s)),t.toLocaleDateString("pt-BR")}function $(){const s=["Ansioso","Tranquilo","Estressado","Feliz","Deprimido","Irritado","Motivado"],t=Math.floor(Math.random()*3)+1,r=[];for(let n=0;n<t;n++){const w=Math.floor(Math.random()*s.length);r.includes(s[w])||r.push(s[w])}return r}const i=x==null?void 0:x.filter(s=>`${s.firstName} ${s.lastName}`.toLowerCase().includes(d.toLowerCase())),v=()=>{if(!i)return[];switch(j){case"recent":return[...i].sort((s,t)=>{const r=new Date(s.lastSession||"");return new Date(t.lastSession||"").getTime()-r.getTime()});case"upcoming":return[...i].sort((s,t)=>{const r=new Date(s.nextSession||""),n=new Date(t.nextSession||"");return r.getTime()-n.getTime()});case"progress":return[...i].sort((s,t)=>(t.progress||0)-(s.progress||0));default:return i}},k=()=>{var s;return a?e.jsxs(h,{className:"h-full",children:[e.jsx(y,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs(P,{className:"h-14 w-14 mr-4",children:[e.jsx(M,{src:a.profilePicture||"",alt:`${a.firstName} ${a.lastName}`}),e.jsxs(T,{className:"bg-primary/10 text-primary-foreground",children:[a.firstName[0],a.lastName[0]]})]}),e.jsxs("div",{children:[e.jsxs(U,{className:"text-xl",children:[a.firstName," ",a.lastName]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.email})]})]}),e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>window.open(`/patient/${a.id}/records`,"_blank"),children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Prontuário"]})]})}),e.jsxs(p,{className:"pt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"rounded-lg bg-primary/5 p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"h-5 w-5 text-primary mr-2"}),e.jsx("h3",{className:"text-sm font-medium",children:"Próxima Sessão"})]}),e.jsx("p",{className:"mt-2 text-lg font-semibold",children:a.nextSession||"Não agendada"})]}),e.jsxs("div",{className:"rounded-lg bg-primary/5 p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(se,{className:"h-5 w-5 text-primary mr-2"}),e.jsx("h3",{className:"text-sm font-medium",children:"Progresso"})]}),e.jsxs("p",{className:"mt-2 text-lg font-semibold",children:[a.progress,"%"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-1 flex items-center",children:[e.jsx(O,{className:"h-4 w-4 mr-2 text-gray-500"}),"Histórico"]}),e.jsxs("p",{className:"text-sm pl-6",children:[e.jsx("span",{className:"font-medium",children:"Última sessão:"})," ",a.lastSession]}),e.jsxs("p",{className:"text-sm pl-6",children:[e.jsx("span",{className:"font-medium",children:"Total de sessões:"})," ",a.sessionCount]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-1 flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-2 text-gray-500"}),"Humor Recente"]}),e.jsx("div",{className:"pl-6",children:(s=a.recentMoods)==null?void 0:s.map((t,r)=>e.jsx(X,{variant:"outline",className:"mr-1 mb-1",children:t},r))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-1 flex items-center",children:[e.jsx(S,{className:"h-4 w-4 mr-2 text-gray-500"}),"Atividades"]}),e.jsxs("p",{className:"text-sm pl-6",children:[e.jsx("span",{className:"font-medium",children:"Entradas no diário:"})," ",a.journalEntries]}),e.jsxs("p",{className:"text-sm pl-6",children:[e.jsx("span",{className:"font-medium",children:"Registros médicos:"})," ",a.medicalRecords]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Notas"}),e.jsx("textarea",{className:"w-full h-24 text-sm p-3 border rounded-lg focus:ring-1 focus:ring-primary focus:outline-none",placeholder:"Adicione notas sobre este paciente..."})]})]}),e.jsxs(J,{className:"flex justify-between",children:[e.jsxs(o,{variant:"outline",className:"w-1/2 mr-2",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Editar Perfil"]}),e.jsxs(o,{className:"w-1/2 ml-2 bg-primary hover:bg-primary/90",children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Enviar Mensagem"]})]})]}):e.jsx(h,{className:"h-full flex items-center justify-center",children:e.jsxs(p,{className:"text-center p-6",children:[e.jsx(Q,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-600",children:"Selecione um paciente para ver detalhes"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Clique em um paciente na lista para visualizar suas informações completas"})]})})};return e.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Meus Pacientes"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie e acompanhe o progresso dos seus pacientes"})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex items-center",children:[e.jsxs(o,{className:"bg-primary hover:bg-primary/90 mr-2",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Novo Paciente"]}),e.jsxs(o,{variant:"outline",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Relatórios"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6",children:[e.jsx("div",{className:"md:col-span-5",children:e.jsxs(h,{className:"h-full",children:[e.jsx(y,{className:"pb-2",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(H,{placeholder:"Buscar pacientes...",className:"pl-8 w-full",value:d,onChange:s=>D(s.target.value)})]}),e.jsx("div",{className:"w-full",children:e.jsx(K,{defaultValue:"all",value:j,onValueChange:R,className:"w-full",children:e.jsxs(W,{className:"grid grid-cols-4 w-full",children:[e.jsx(m,{value:"all",className:"text-[9px] xxs:text-xs sm:text-sm py-1 h-9 px-0 whitespace-nowrap overflow-hidden text-ellipsis leading-none",children:"Todos"}),e.jsx(m,{value:"recent",className:"text-[9px] xxs:text-xs sm:text-sm py-1 h-9 px-0 whitespace-nowrap overflow-hidden text-ellipsis leading-none",children:"Recentes"}),e.jsx(m,{value:"upcoming",className:"text-[9px] xxs:text-xs sm:text-sm py-1 h-9 px-0 whitespace-nowrap overflow-hidden text-ellipsis leading-none",children:"Próximos"}),e.jsx(m,{value:"progress",className:"text-[9px] xxs:text-xs sm:text-sm py-1 h-9 px-0 whitespace-nowrap overflow-hidden text-ellipsis leading-none",children:"Progresso"})]})})})]})}),e.jsx(p,{className:"p-0",children:e.jsx(V,{className:"h-[calc(100vh-270px)] w-full",enableMouseWheel:!0,children:B?e.jsx("div",{className:"p-4 space-y-4",children:Array.from({length:5}).map((s,t)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(u,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"h-4 w-[200px]"}),e.jsx(u,{className:"h-4 w-[160px]"})]})]},t))}):v().length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 p-4",children:[e.jsx(G,{className:"h-8 w-8 text-gray-300 mb-2"}),e.jsx("p",{className:"text-gray-500 text-center",children:d?"Nenhum paciente encontrado com este nome":"Você ainda não tem pacientes"})]}):e.jsx("div",{className:"divide-y",children:v().map(s=>e.jsxs("div",{className:`p-4 flex cursor-pointer transition-colors hover:bg-gray-50 ${(a==null?void 0:a.id)===s.id?"bg-primary/5":""}`,onClick:()=>E(s),children:[e.jsxs(P,{className:"h-12 w-12 mr-4",children:[e.jsx(M,{src:s.profilePicture||"",alt:`${s.firstName} ${s.lastName}`}),e.jsxs(T,{className:"bg-primary/10 text-primary",children:[s.firstName[0],s.lastName[0]]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("h3",{className:"font-medium text-gray-900",children:[s.firstName," ",s.lastName]}),e.jsx(ee,{className:"h-4 w-4 text-gray-400"})]}),e.jsxs("div",{className:"mt-1 flex items-center text-sm text-gray-500",children:[e.jsx(b,{className:"h-3.5 w-3.5 mr-1 text-gray-400"}),e.jsxs("p",{children:["Próxima: ",s.nextSession||"Não agendada"]})]}),e.jsxs("div",{className:"mt-2 flex items-center",children:[e.jsx("div",{className:"h-1.5 flex-1 rounded-full bg-gray-200",title:`Progresso: ${s.progress}%`,children:e.jsx("div",{className:"h-1.5 rounded-full bg-primary",style:{width:`${s.progress}%`}})}),e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:[s.progress,"%"]})]})]})]},s.id))})})})]})}),e.jsx("div",{className:"md:col-span-7",children:k()})]})]})}export{pe as default};
